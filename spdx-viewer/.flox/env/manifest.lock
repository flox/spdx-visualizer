{
  "lockfile-version": 1,
  "manifest": {
    "version": 1,
    "install": {
      "chromium": {
        "pkg-path": "chromium",
        "systems": [
          "x86_64-linux",
          "aarch64-linux"
        ]
      },
      "mermaid-cli": {
        "pkg-path": "mermaid-cli"
      },
      "python3": {
        "pkg-path": "python3"
      },
      "spdx-to-mermaid": {
        "pkg-path": "flox/spdx-to-mermaid",
        "systems": [
          "x86_64-linux"
        ]
      }
    },
    "hook": {
      "on-activate": "  # Create viewer assets if they don't exist\n  if [ ! -f \"$FLOX_ENV_PROJECT/viewer.html\" ]; then\n    cat > \"$FLOX_ENV_PROJECT/viewer.html\" << 'EOF_VIEWER'\n<!doctype html>\n<html>\n<head>\n  <meta charset=\"utf-8\" />\n  <title>SVG Viewer</title>\n  <style>\n    html, body { margin:0; height:100%; overflow:hidden; background:#111; }\n    iframe { width:100%; height:100%; border:none; }\n    .hud {\n      position:fixed; top:10px; left:10px; z-index:10;\n      font:14px system-ui; color:#eee; background:#000a; padding:6px 8px; border-radius:8px;\n    }\n    button { margin-right:6px; }\n  </style>\n</head>\n<body>\n  <div class=\"hud\">\n    <button id=\"zin\">+</button>\n    <button id=\"zout\">âˆ’</button>\n    <button id=\"reset\">reset</button>\n    <span id=\"zread\">100.0%</span>\n  </div>\n\n  <iframe id=\"svgFrame\" src=\"diagram.svg\"></iframe>\n\n  <script>\n    const frame = document.getElementById('svgFrame');\n    const zread = document.getElementById('zread');\n    let state = { scale: 1, x: 0, y: 0 };\n    let svg, g;\n\n    function apply() {\n      if (!g) return;\n      g.setAttribute('transform', `translate(${state.x},${state.y}) scale(${state.scale})`);\n      zread.textContent = (state.scale * 100).toFixed(1) + '%';\n    }\n\n    frame.addEventListener('load', () => {\n      try {\n        svg = frame.contentDocument || frame.contentWindow.document;\n        console.log('Frame loaded, document:', svg);\n\n        if (!svg) {\n          console.error('Cannot access frame document');\n          zread.textContent = 'Error: Cannot access SVG';\n          return;\n        }\n\n        const root = svg.documentElement;\n        console.log('SVG root:', root);\n\n        // Wrap all contents in a group\n        g = svg.createElementNS('http://www.w3.org/2000/svg', 'g');\n        while (root.firstChild) {\n          g.appendChild(root.firstChild);\n        }\n        root.appendChild(g);\n\n        apply();\n\n        let dragging = false, lastX = 0, lastY = 0;\n\n        // Zoom\n        root.addEventListener('wheel', (e) => {\n          e.preventDefault();\n          const factor = e.deltaY < 0 ? 1.12 : 0.89;\n\n          // cursor position in screen coords (relative to iframe content)\n          const cx = e.clientX;\n          const cy = e.clientY;\n\n          // adjust translation so point under cursor stays put\n          state.x = cx - factor * (cx - state.x);\n          state.y = cy - factor * (cy - state.y);\n          state.scale *= factor;\n\n          apply();\n        }, { passive: false });\n\n        // Pan\n        root.addEventListener('mousedown', (e) => {\n          dragging = true;\n          lastX = e.clientX;\n          lastY = e.clientY;\n          e.preventDefault();\n        });\n\n        root.addEventListener('mousemove', (e) => {\n          if (!dragging) return;\n          // Scale pan speed by current zoom level for more responsive panning\n          const panSpeed = Math.max(1, state.scale * 2);\n          state.x += (e.clientX - lastX) * panSpeed;\n          state.y += (e.clientY - lastY) * panSpeed;\n          lastX = e.clientX;\n          lastY = e.clientY;\n          apply();\n        });\n\n        root.addEventListener('mouseup', () => { dragging = false; });\n        root.addEventListener('mouseleave', () => { dragging = false; });\n\n      } catch(err) {\n        console.error('Error accessing frame:', err);\n        zread.textContent = 'Error: ' + err.message;\n      }\n    });\n\n    // Buttons\n    document.getElementById('zin').onclick = () => { state.scale *= 1.25; apply(); };\n    document.getElementById('zout').onclick = () => { state.scale /= 1.25; apply(); };\n    document.getElementById('reset').onclick = () => { state = {scale:1,x:0,y:0}; apply(); };\n  </script>\n</body>\n</html>\nEOF_VIEWER\n  fi\n\n  if [ ! -f \"$FLOX_ENV_PROJECT/mermaid-config.json\" ]; then\n    cat > \"$FLOX_ENV_PROJECT/mermaid-config.json\" << 'EOF_MERMAID'\n{\n  \"maxTextSize\": 1000000,\n  \"maxEdges\": 10000,\n  \"flowchart\": { \"htmlLabels\": false },\n  \"sequence\": { \"htmlLabels\": false },\n  \"class\": { \"htmlLabels\": false },\n  \"state\": { \"htmlLabels\": false },\n  \"er\": { \"htmlLabels\": false },\n  \"gantt\": { \"htmlLabels\": false },\n  \"journey\": { \"htmlLabels\": false },\n  \"mindmap\": { \"htmlLabels\": false },\n  \"timeline\": { \"htmlLabels\": false },\n  \"htmlLabels\": false\n}\nEOF_MERMAID\n  fi\n\n  if [ ! -f \"$FLOX_ENV_PROJECT/puppeteer-config.json\" ]; then\n    cat > \"$FLOX_ENV_PROJECT/puppeteer-config.json\" << 'EOF_PUPPETEER'\n{\n  \"args\": [\"--no-sandbox\", \"--disable-setuid-sandbox\"]\n}\nEOF_PUPPETEER\n  fi\n"
    },
    "profile": {
      "common": "  # SPDX Viewer Functions\n\n  # Show SPDX file as interactive SVG diagram in browser\n  spdx-show() {\n    if [ $# -eq 0 ]; then\n      echo \"Usage: spdx-show <spdx-file> [options]\"\n      echo \"Example: spdx-show file.spdx.json --compact --max-packages 10\"\n      return 1\n    fi\n\n    local spdx_file=\"$1\"\n    shift\n    local extra_args=\"$@\"\n\n    # Resolve to absolute path\n    spdx_file=$(realpath \"$spdx_file\")\n\n    # Create temp file for mermaid\n    local temp_base=$(mktemp)\n    local mmd_file=\"${temp_base}.mmd\"\n    mv \"$temp_base\" \"$mmd_file\"\n\n    local svg_file=\"$FLOX_ENV_PROJECT/diagram.svg\"\n    local config_path=\"$FLOX_ENV_PROJECT/mermaid-config.json\"\n\n    # Start HTTP server if not running\n    if ! lsof -i:3000 -sTCP:LISTEN -t >/dev/null 2>&1; then\n      echo \"Starting HTTP server...\"\n      flox services start http-server\n      sleep 1\n    fi\n\n    # Generate mermaid diagram\n    spdx-to-mermaid \"$spdx_file\" $extra_args > \"$mmd_file\"\n\n    # Convert to SVG\n    mmdc -i \"$mmd_file\" -o \"$svg_file\" --configFile \"$config_path\" -p \"$FLOX_ENV_PROJECT/puppeteer-config.json\"\n\n    # Open in browser\n    CHROME_DEVEL_SANDBOX=\"\" chromium --no-sandbox \"http://localhost:3000/viewer.html\"\n\n    # Cleanup\n    rm -f \"$mmd_file\"\n  }\n\n  # Convert SPDX to SVG file\n  spdx-svg() {\n    if [ $# -eq 0 ]; then\n      echo \"Usage: spdx-svg <spdx-file> [output.svg] [options]\"\n      echo \"Example: spdx-svg file.spdx.json diagram.svg --compact\"\n      return 1\n    fi\n\n    local spdx_file=\"$1\"\n    local output=\"${2:-diagram.svg}\"\n    shift 2 2>/dev/null || shift 1\n    local extra_args=\"$@\"\n\n    # Create temp file\n    local temp_base=$(mktemp)\n    local mmd_file=\"${temp_base}.mmd\"\n    mv \"$temp_base\" \"$mmd_file\"\n\n    # Generate and convert\n    spdx-to-mermaid \"$spdx_file\" $extra_args > \"$mmd_file\"\n    mmdc -i \"$mmd_file\" -o \"$output\" --configFile \"$FLOX_ENV_PROJECT/mermaid-config.json\"\n    rm -f \"$mmd_file\"\n\n    echo \"Created $output\"\n  }\n\n  # Start HTTP server\n  spdx-serve() {\n    flox services start http-server\n    echo \"HTTP server started on http://localhost:3000\"\n  }\n\n  # Stop all services\n  spdx-stop() {\n    flox services stop\n  }\n\n  echo \"SPDX Viewer environment activated!\"\n  echo \"\"\n  echo \"Available commands:\"\n  echo \"  spdx-show <file>         - View SPDX file as interactive diagram\"\n  echo \"  spdx-svg <file> [out]    - Convert SPDX to SVG file\"\n  echo \"  spdx-to-mermaid <file>   - Convert SPDX to Mermaid (stdout)\"\n  echo \"  spdx-serve               - Start HTTP server\"\n  echo \"  spdx-stop                - Stop services\"\n  echo \"\"\n"
    },
    "options": {},
    "services": {
      "http-server": {
        "command": "cd $FLOX_ENV_PROJECT && python3 -m http.server 3000"
      }
    }
  },
  "packages": [
    {
      "attr_path": "chromium",
      "broken": false,
      "derivation": "/nix/store/90i3f88lhjan28pdfw4x0hpddv640sz0-chromium-142.0.7444.59.drv",
      "description": "Open source web browser from Google",
      "install_id": "chromium",
      "license": "BSD-3-Clause",
      "locked_url": "https://github.com/flox/nixpkgs?rev=b3d51a0365f6695e7dd5cdf3e180604530ed33b4",
      "name": "chromium-142.0.7444.59",
      "pname": "chromium",
      "rev": "b3d51a0365f6695e7dd5cdf3e180604530ed33b4",
      "rev_count": 888552,
      "rev_date": "2025-11-02T19:18:41Z",
      "scrape_date": "2025-11-05T16:28:57.649470Z",
      "stabilities": [
        "unstable"
      ],
      "unfree": false,
      "version": "142.0.7444.59",
      "outputs_to_install": [
        "out"
      ],
      "outputs": {
        "out": "/nix/store/j292mp595k3l5wy1gh5nx5i4l327d3iw-chromium-142.0.7444.59",
        "sandbox": "/nix/store/hsns1zvgcf2d0gjsh5nvzyvhnnkn24qx-chromium-142.0.7444.59-sandbox"
      },
      "system": "aarch64-linux",
      "group": "toplevel",
      "priority": 5
    },
    {
      "attr_path": "chromium",
      "broken": false,
      "derivation": "/nix/store/kjjx24pgqi120fsxlclwhd9340f6bpgh-chromium-142.0.7444.59.drv",
      "description": "Open source web browser from Google",
      "install_id": "chromium",
      "license": "BSD-3-Clause",
      "locked_url": "https://github.com/flox/nixpkgs?rev=b3d51a0365f6695e7dd5cdf3e180604530ed33b4",
      "name": "chromium-142.0.7444.59",
      "pname": "chromium",
      "rev": "b3d51a0365f6695e7dd5cdf3e180604530ed33b4",
      "rev_count": 888552,
      "rev_date": "2025-11-02T19:18:41Z",
      "scrape_date": "2025-11-05T17:20:46.951093Z",
      "stabilities": [
        "unstable"
      ],
      "unfree": false,
      "version": "142.0.7444.59",
      "outputs_to_install": [
        "out"
      ],
      "outputs": {
        "out": "/nix/store/bj09y0p98p3rw6bzplmbawdywi4yb8wk-chromium-142.0.7444.59",
        "sandbox": "/nix/store/46lfqsgr5z5i5yyy29dz5f844frc506j-chromium-142.0.7444.59-sandbox"
      },
      "system": "x86_64-linux",
      "group": "toplevel",
      "priority": 5
    },
    {
      "attr_path": "mermaid-cli",
      "broken": false,
      "derivation": "/nix/store/laf6bcvjp4cl2fgacb9kxj583z0wvyix-mermaid-cli-11.12.0.drv",
      "description": "Generation of diagrams from text in a similar manner as markdown",
      "install_id": "mermaid-cli",
      "license": "MIT",
      "locked_url": "https://github.com/flox/nixpkgs?rev=b3d51a0365f6695e7dd5cdf3e180604530ed33b4",
      "name": "mermaid-cli-11.12.0",
      "pname": "mermaid-cli",
      "rev": "b3d51a0365f6695e7dd5cdf3e180604530ed33b4",
      "rev_count": 888552,
      "rev_date": "2025-11-02T19:18:41Z",
      "scrape_date": "2025-11-04T00:35:38.130202Z",
      "stabilities": [
        "unstable"
      ],
      "unfree": false,
      "version": "11.12.0",
      "outputs_to_install": [
        "out"
      ],
      "outputs": {
        "out": "/nix/store/mri1mrl657p3dl8l4wclybwcgbz978ab-mermaid-cli-11.12.0"
      },
      "system": "aarch64-darwin",
      "group": "toplevel",
      "priority": 5
    },
    {
      "attr_path": "mermaid-cli",
      "broken": false,
      "derivation": "/nix/store/b9lbnrpdn4s5ilpzz8dj2bpf54n66bic-mermaid-cli-11.12.0.drv",
      "description": "Generation of diagrams from text in a similar manner as markdown",
      "install_id": "mermaid-cli",
      "license": "MIT",
      "locked_url": "https://github.com/flox/nixpkgs?rev=b3d51a0365f6695e7dd5cdf3e180604530ed33b4",
      "name": "mermaid-cli-11.12.0",
      "pname": "mermaid-cli",
      "rev": "b3d51a0365f6695e7dd5cdf3e180604530ed33b4",
      "rev_count": 888552,
      "rev_date": "2025-11-02T19:18:41Z",
      "scrape_date": "2025-11-05T16:29:31.268932Z",
      "stabilities": [
        "unstable"
      ],
      "unfree": false,
      "version": "11.12.0",
      "outputs_to_install": [
        "out"
      ],
      "outputs": {
        "out": "/nix/store/rn7qwm6ipdb0d7qhif68dvb129yr9nhh-mermaid-cli-11.12.0"
      },
      "system": "aarch64-linux",
      "group": "toplevel",
      "priority": 5
    },
    {
      "attr_path": "mermaid-cli",
      "broken": false,
      "derivation": "/nix/store/xayxhxzk44sqyqk04drkcy0nv2warlja-mermaid-cli-11.12.0.drv",
      "description": "Generation of diagrams from text in a similar manner as markdown",
      "install_id": "mermaid-cli",
      "license": "MIT",
      "locked_url": "https://github.com/flox/nixpkgs?rev=b3d51a0365f6695e7dd5cdf3e180604530ed33b4",
      "name": "mermaid-cli-11.12.0",
      "pname": "mermaid-cli",
      "rev": "b3d51a0365f6695e7dd5cdf3e180604530ed33b4",
      "rev_count": 888552,
      "rev_date": "2025-11-02T19:18:41Z",
      "scrape_date": "2025-11-05T16:55:17.869543Z",
      "stabilities": [
        "unstable"
      ],
      "unfree": false,
      "version": "11.12.0",
      "outputs_to_install": [
        "out"
      ],
      "outputs": {
        "out": "/nix/store/ca7sdr5l58nap31am88isxx7rn6xadv7-mermaid-cli-11.12.0"
      },
      "system": "x86_64-darwin",
      "group": "toplevel",
      "priority": 5
    },
    {
      "attr_path": "mermaid-cli",
      "broken": false,
      "derivation": "/nix/store/qrndrk27bl93qghgix108r8ymg33a0xa-mermaid-cli-11.12.0.drv",
      "description": "Generation of diagrams from text in a similar manner as markdown",
      "install_id": "mermaid-cli",
      "license": "MIT",
      "locked_url": "https://github.com/flox/nixpkgs?rev=b3d51a0365f6695e7dd5cdf3e180604530ed33b4",
      "name": "mermaid-cli-11.12.0",
      "pname": "mermaid-cli",
      "rev": "b3d51a0365f6695e7dd5cdf3e180604530ed33b4",
      "rev_count": 888552,
      "rev_date": "2025-11-02T19:18:41Z",
      "scrape_date": "2025-11-05T17:21:23.838307Z",
      "stabilities": [
        "unstable"
      ],
      "unfree": false,
      "version": "11.12.0",
      "outputs_to_install": [
        "out"
      ],
      "outputs": {
        "out": "/nix/store/zd6kylch11ahdj6mxqmmrqhds3rr01kw-mermaid-cli-11.12.0"
      },
      "system": "x86_64-linux",
      "group": "toplevel",
      "priority": 5
    },
    {
      "attr_path": "python3",
      "broken": false,
      "derivation": "/nix/store/3myrb1pixxdm651xcsghs4p6syz0rx9i-python3-3.13.8.drv",
      "description": "High-level dynamically-typed programming language",
      "install_id": "python3",
      "license": "Python-2.0",
      "locked_url": "https://github.com/flox/nixpkgs?rev=b3d51a0365f6695e7dd5cdf3e180604530ed33b4",
      "name": "python3-3.13.8",
      "pname": "python3",
      "rev": "b3d51a0365f6695e7dd5cdf3e180604530ed33b4",
      "rev_count": 888552,
      "rev_date": "2025-11-02T19:18:41Z",
      "scrape_date": "2025-11-04T00:35:56.837163Z",
      "stabilities": [
        "unstable"
      ],
      "unfree": false,
      "version": "3.13.8",
      "outputs_to_install": [
        "out"
      ],
      "outputs": {
        "out": "/nix/store/s7ik6dazn4nd2jdg9l36qf5q0z18sjyk-python3-3.13.8"
      },
      "system": "aarch64-darwin",
      "group": "toplevel",
      "priority": 5
    },
    {
      "attr_path": "python3",
      "broken": false,
      "derivation": "/nix/store/4sjw3f3s8nf705jpcvvsh3ibpicqj8cb-python3-3.13.8.drv",
      "description": "High-level dynamically-typed programming language",
      "install_id": "python3",
      "license": "Python-2.0",
      "locked_url": "https://github.com/flox/nixpkgs?rev=b3d51a0365f6695e7dd5cdf3e180604530ed33b4",
      "name": "python3-3.13.8",
      "pname": "python3",
      "rev": "b3d51a0365f6695e7dd5cdf3e180604530ed33b4",
      "rev_count": 888552,
      "rev_date": "2025-11-02T19:18:41Z",
      "scrape_date": "2025-11-05T16:29:59.207269Z",
      "stabilities": [
        "unstable"
      ],
      "unfree": false,
      "version": "3.13.8",
      "outputs_to_install": [
        "out"
      ],
      "outputs": {
        "debug": "/nix/store/53m4xy9yaar25rc2g85fb3qvjxnwfhq5-python3-3.13.8-debug",
        "out": "/nix/store/m0b67b3lmjcxa8aplpl75qpb26gr5vsf-python3-3.13.8"
      },
      "system": "aarch64-linux",
      "group": "toplevel",
      "priority": 5
    },
    {
      "attr_path": "python3",
      "broken": false,
      "derivation": "/nix/store/hgr3c3s4dq87qdzbyb0rqw2cz7yxnqgr-python3-3.13.8.drv",
      "description": "High-level dynamically-typed programming language",
      "install_id": "python3",
      "license": "Python-2.0",
      "locked_url": "https://github.com/flox/nixpkgs?rev=b3d51a0365f6695e7dd5cdf3e180604530ed33b4",
      "name": "python3-3.13.8",
      "pname": "python3",
      "rev": "b3d51a0365f6695e7dd5cdf3e180604530ed33b4",
      "rev_count": 888552,
      "rev_date": "2025-11-02T19:18:41Z",
      "scrape_date": "2025-11-05T16:55:36.404976Z",
      "stabilities": [
        "unstable"
      ],
      "unfree": false,
      "version": "3.13.8",
      "outputs_to_install": [
        "out"
      ],
      "outputs": {
        "out": "/nix/store/ddvx7n1y63g4i9bg0bim3r4ick1cc8x9-python3-3.13.8"
      },
      "system": "x86_64-darwin",
      "group": "toplevel",
      "priority": 5
    },
    {
      "attr_path": "python3",
      "broken": false,
      "derivation": "/nix/store/nd0m36nc8xf05cdb9pi4jjyqsk1xzgxv-python3-3.13.8.drv",
      "description": "High-level dynamically-typed programming language",
      "install_id": "python3",
      "license": "Python-2.0",
      "locked_url": "https://github.com/flox/nixpkgs?rev=b3d51a0365f6695e7dd5cdf3e180604530ed33b4",
      "name": "python3-3.13.8",
      "pname": "python3",
      "rev": "b3d51a0365f6695e7dd5cdf3e180604530ed33b4",
      "rev_count": 888552,
      "rev_date": "2025-11-02T19:18:41Z",
      "scrape_date": "2025-11-05T17:21:54.126584Z",
      "stabilities": [
        "unstable"
      ],
      "unfree": false,
      "version": "3.13.8",
      "outputs_to_install": [
        "out"
      ],
      "outputs": {
        "debug": "/nix/store/ckj4gnblikbb37gvydggaicw6f0kmcx3-python3-3.13.8-debug",
        "out": "/nix/store/cfapjd2rvqrpry4grb0kljnp8bvnvfxz-python3-3.13.8"
      },
      "system": "x86_64-linux",
      "group": "toplevel",
      "priority": 5
    },
    {
      "attr_path": "spdx-to-mermaid",
      "derivation": "/nix/store/b0m12faj8azp6zgg1s6drqppimqx51xl-spdx-to-mermaid-0.1.0.drv",
      "description": "Convert SPDX files to Mermaid diagrams",
      "install_id": "spdx-to-mermaid",
      "locked_url": "git@github.com:flox/spdx-visualizer?rev=0ba6be4d753b9c638037052d4f6d37bea05de228",
      "name": "spdx-to-mermaid-0.1.0",
      "pname": "spdx-to-mermaid",
      "rev": "0ba6be4d753b9c638037052d4f6d37bea05de228",
      "rev_count": 10,
      "rev_date": "2026-02-04T14:49:59Z",
      "scrape_date": "2026-02-04T14:55:24.924643117Z",
      "stabilities": [
        "unstable"
      ],
      "version": "0.1.0",
      "outputs_to_install": [
        "out"
      ],
      "outputs": {
        "out": "/nix/store/x9bbjsbzaq7yllrg6n2l8pcfjimjw73q-spdx-to-mermaid-0.1.0"
      },
      "system": "x86_64-linux",
      "group": "toplevel",
      "priority": 5
    }
  ]
}
